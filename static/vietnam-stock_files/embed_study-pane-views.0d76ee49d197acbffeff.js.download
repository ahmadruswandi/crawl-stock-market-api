webpackJsonp([14],{1161:function(t,e,i){"use strict";var n,a,o,s,r,l,d,h;Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"PolygonPaneView",function(){return h}),n=i(6),i.n(n),a=i(14),i.n(a),o=i(33),s=i(22),r=i(93),l=i(116),d=i(1939),h=function(){function t(t,e){this._data=[],this._invalidated=!0,this._study=t,this._model=e}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,n,a;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new r.CompositeRenderer,e=0,i=this._data;e<i.length;e++)n=i[e],a=new d.PolygonRenderer(new s.HitTestResult(s.HitTestResult.REGULAR)),a.setData(n),t.append(a);return t},t.prototype._updateViewInternal=function(){var t,e,i,s,r,d,h,u=this;this._data=[],t=this._study.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||(i=this._study.graphics().polygons(),0!==i.size&&null!==(s=this._model.timeScale().visibleBars())&&null!=(r=this._study.firstValue())&&(d=s.firstBar(),h=s.lastBar(),i.forEach(function(i,s){var c,p,_,f,y=u._study.properties().graphics.polygons[s];if(100!==y.transparency.value())for(c=function(i){var s,c,p,_,f,g,v,w,x,T,m,b,R=i.indexes;for(s=0,c=i.items;s<c.length;s++){for(p=c[s],_=1/0,f=-1/0,g=!1,v=0,w=p.points;v<w.length;v++){if(x=w[v],(T=R[x.index])===o.REMOVE_INDEX_MAGIC_NUMBER){g=!0;break}m=T+(x.offset||0),_=Math.min(_,m),f=Math.max(f,m)}g||f<d||h<_||(b=p.points.map(function(i){var o=e.indexToCoordinate(R[i.index]+(i.offset||0)),s=t.priceToCoordinate(Object(n.ensureDefined)(i.level),r);return new a.Point(o,s)}),u._data.push({points:b,color:y.color.value(),backcolor:y.color.value(),linewidth:void 0!==y.showBorder&&y.showBorder.value()?1:0,linestyle:l.LINESTYLE_SOLID,filled:!0,fillBackground:!0,transparency:y.transparency.value(),mouseTouchable:y.mouseTouchable.value()}))}},p=0,_=i;p<_.length;p++)f=_[p],c(f)})))},t}()},1219:function(t,e,i){"use strict";function n(t,e,i,n,o,s){var r,l,d,u,c,p,_,f,y,g=o.location===h.b.Absolute,v=o.location===h.b.Relative,w=o.direction===h.a.LeftToRight,x=o.direction===h.a.RightToLeft;if(g&&w)r=i.indexToCoordinate(n[t.firstBarTime]),l=1,d="left";else if(g&&x)r=i.indexToCoordinate(n[t.lastBarTime]),l=-1,d="right";else if(v&&w)r=0,l=1,d="left";else{if(!v||!x)throw Error("Unknown location/direction values: "+o.location+"/"+o.direction);r=i.width(),l=-1,d="right"}return u=a(t,e,s),c=u.y2-u.y1,p=c>=2?1:0,_=Math.round(u.y1),f=Math.round(u.y2)-p,y=Math.round(.6*c),{xBasePoint:r,sign:l,fontSize:y,textHAligh:d,y1:_,y2:f}}function a(t,e,i){var n=Object(o.ensure)(i.firstValue());return{y1:e.priceToCoordinate(t.priceHigh,n,!0),y2:e.priceToCoordinate(t.priceLow,n,!0)}}var o,s,r,l,d,h,u,c,p,_,f;Object.defineProperty(e,"__esModule",{value:!0}),o=i(6),s=i(14),r=i(130),l=i(33),d=i(22),h=i(2130),u=i(93),c=i(411),p=function(){function t(t){this._data=t}return t.prototype.hitTest=function(t){var e,i,n,a,o,s,r,l,h=this._data.histsBySession;for(e in h)if(h.hasOwnProperty(e)&&(i=e.split(" ").map(parseFloat),n=i[0],a=i[1],t.x>=n&&t.x<=a)){for(o=h[e],s=0,
r=o;s<r.length;s++)if(l=r[s],t.y>=l.y1&&t.y<=l.y2&&t.x>=l.x1&&t.x<=l.x2)return new d.HitTestResult(d.HitTestResult.REGULAR);return null}return null},t.prototype.draw=function(t){var e,i,n,a,o,s,r,l,d,h,u=this._data;t.save();for(e in u.histsByLineWidth)if(u.histsByLineWidth.hasOwnProperty(e)){i=parseInt(e,10),n=u.histsByLineWidth[e],a=i%2==0?.5:0,o=Math.round(i/2);for(s in n)if(n.hasOwnProperty(s)){for(t.strokeStyle=s,t.lineWidth=i*(window.hidpiCanvasRatio||1),t.beginPath(),r=n[s],l=0,d=r;l<d.length;l++)h=d[l],t.moveTo(h.x1+.5,h.y1+o+a),t.lineTo(h.x2+.5,h.y1+o+a);t.stroke()}}t.restore()},t}(),_=i(96),i.d(e,"HHistPaneView",function(){return f}),f=function(){function t(t,e){this._invalidated=!0,this._study=t,this._model=e,this._rendererData={histsByLineWidth:{},histsBySession:{}},this._textData=[],this._styles={},this._hhistRenderer=new p(this._rendererData)}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,n;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new u.CompositeRenderer,t.append(this._hhistRenderer),e=0,i=this._textData;e<i.length;e++)n=i[e],t.append(new c.TextRenderer(n,new d.HitTestResult(d.HitTestResult.REGULAR)));return t},t.prototype._resetRenderersData=function(){this._rendererData.histsByLineWidth={},this._rendererData.histsBySession={},this._textData=[]},t.prototype._prepareStyles=function(){var t,e,i,n,a,s,r=Object.keys(Object(o.ensureDefined)(this._study.metaInfo().graphics.hhists)),l=this._study.properties().graphics.hhists;for(t=0,e=r;t<e.length;t++)i=e[t],n=Object(o.ensureDefined)(l.child(i)),a=Object(_.generateColor)(n.colors[0].value(),n.transparencies[0].value()),s=n.colors[1]?Object(_.generateColor)(n.colors[1].value(),n.transparencies[1].value()):a,this._styles[i]={colors:[a,s],visible:n.visible.value(),percentWidth:n.percentWidth.value(),location:n.location.value(),direction:n.direction.value(),showValues:n.showValues.value(),valuesColor:n.valuesColor.value()}},t.prototype._updateViewInternal=function(){var t,e,i,n,a,s,r,l,d=this;this._resetRenderersData(),t=this._study.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||null!=this._study.firstValue()&&(i=this._study.graphics().hhistsByTimePointIndex(),0!==i.size&&null!==(n=this._model.timeScale().visibleBars())&&(a=n.firstBar(),s=n.lastBar(),r="histBars",this._prepareStyles(),l=this._study.graphics().hhistsByTimePointIndex().get(r),Object(o.ensureDefined)(l).forEach(function(i,n){var o,r,l=i.indexes,h=i.items,u=1/0,c=-1/0;for(o=h.length;o--;)r=h[o],u=Math.min(u,l[r.firstBarTime]),c=Math.max(c,l[r.lastBarTime]);c<a||u>s||d._updateDataForRenderers(h,t,e,l)})))},t.prototype._updateDataForRenderers=function(t,e,i,a){var o,d,h,u,c,p,_,f,y,g,v,w,x,T,m,b,R,L,P,M,C,E,B,O,S,k,A,D,I,j,H,V,N,z,U=[],G={},W={},X={},Y=e.height(),F=this._rendererData.histsByLineWidth,q=this._rendererData.histsBySession;if(!(t.length<=0)){for(o=!1,d=t[0],h=0,u=0,c=t;u<c.length;u++)p=c[u],_=p.rate.reduce(function(t,e){return t+e}),h=Math.max(h,_),p.priceLow<d.priceLow&&(d=p)
;if(a[t[0].firstBarTime]!==l.REMOVE_INDEX_MAGIC_NUMBER&&a[t[0].lastBarTime]!==l.REMOVE_INDEX_MAGIC_NUMBER){for(f=Math.abs(i.indexToCoordinate(a[t[0].firstBarTime])-i.indexToCoordinate(a[t[0].lastBarTime])),y=0;y<t.length;y++)if(p=t[y],g=this._styles[p.styleId],g.visible){if(null==p.rate[p.rate.length-1]&&p.rate.splice(-1,1),g.showValues)for(v=0;v<p.rate.length;v++)U[v]=(U[v]||0)+p.rate[v];if(w=n(p,e,i,a,g,this._study),x=w.xBasePoint,T=w.sign,m=w.fontSize,b=w.textHAligh,R=w.y1,L=w.y2,!(R>Y||L<0)){for(P=Math.max(g.percentWidth*f/100-p.rate.length,0),M=p.rate.reduce(function(t,e){return t+e}),C=T>0?x:x-P,E=T>0?x+P:x,B=C+" "+E,O=T>0?{x1:x,x2:x+P*M/h,y1:R,y2:L}:{x1:x-P*M/h,x2:x,y1:R,y2:L},S=q[B],S?S.push(O):q[B]=[O],v=0;v<p.rate.length;v++)k={x1:0,y1:0,x2:0,y2:0},k.y1=R,k.y2=L,k.x1=0===v?x:x+T*(P*p.rate[v-1]/h),k.x2=k.x1+T*(P*p.rate[v]/h),Math.abs(k.y1-G[v])<1?(W[v]?W[v].push(k.x1):W[v]=[k.x1],X[v]?X[v].push(k.x2):X[v]=[k.x2]):((W[v]||X[v])&&(W[v].push(k.x1),X[v].push(k.x2),k.x1=Math.max.apply(null,W[v]),k.x2=Math.max.apply(null,X[v]),delete W[v],delete X[v]),G[v]=k.y1,Math.abs(k.x2-k.x1)<.5||(A=g.colors[v],D=Math.round(k.y2-k.y1),F[D]||(F[D]={}),I=F[D],I[A]?I[A].push(k):I[A]=[k]));!g.showValues||m<7.5||(o=!0,j=x+3*T,H=L-.61*(L-R),V={text:this._formatRate(p.rate,g.direction),color:g.valuesColor,font:"arial",fontsize:m,horzAlign:b,vertAlign:"middle",points:[new s.Point(j,H)],offsetX:0,offsetY:0,forceTextAlign:!0},this._textData.push(V))}}o&&(g=this._styles[d.styleId],N=n(d,e,i,a,g,this._study),x=N.xBasePoint,T=N.sign,m=N.fontSize,b=N.textHAligh,R=N.y1,L=N.y2,j=x+3*T,H=L+.39*(L-R),z={text:this._formatRate(U,g.direction),color:Object(r.shiftColor)(g.valuesColor,1.5),font:"arial",fontsize:m,horzAlign:b,vertAlign:"middle",points:[new s.Point(j,H)],offsetX:0,offsetY:0,forceTextAlign:!0},this._textData.push(z))}}},t.prototype._formatRate=function(t,e){e===h.a.RightToLeft&&(t=t.slice(),t.reverse());var i=this._study.formatter();return t.map(i.format,i).join("x")},t}()},1220:function(t,e,i){"use strict";var n,a,o,s,r,l,d,h;Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"HorizLinePaneView",function(){return h}),n=i(6),i.n(n),a=i(14),i.n(a),o=i(33),s=i(22),r=i(93),l=i(155),d=i(346),i.n(d),h=function(){function t(t,e){this._data=[],this._invalidated=!0,this._study=t,this._model=e}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,n,a;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new r.CompositeRenderer,e=0,i=this._data;e<i.length;e++)n=i[e],a=new d.TrendLineRenderer,a.setData(n),a.setHitTest(new s.HitTestResult(s.HitTestResult.REGULAR)),t.append(a);return t},t.prototype._updateViewInternal=function(){var t,e,i,s,r,d,h,u=this;this._data=[],t=this._study.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||(i=this._study.graphics().horizlines(),0!==i.size&&null!==(s=this._model.timeScale().visibleBars())&&null!=(r=this._study.firstValue())&&(d=s.firstBar(),h=s.lastBar(),i.forEach(function(i,s){
var c,p,_,f,y,g,v,w,x,T,m,b,R,L,P=u._study.properties().graphics.horizlines[s];if(P.visible.value())for(c=0,p=i;c<p.length;c++)for(_=p[c],f=_.indexes,y=0,g=_.items;y<g.length;y++)v=g[y],w=f[v.startIndex],x=f[v.endIndex],w===o.REMOVE_INDEX_MAGIC_NUMBER||x===o.REMOVE_INDEX_MAGIC_NUMBER||!v.extendRight&&Math.max(w,x)<d||!v.extendLeft&&Math.min(w,x)>h||(T=e.indexToCoordinate(w),m=e.indexToCoordinate(x),b=t.priceToCoordinate(Object(n.ensureDefined)(v.level),r),R=new a.Point(T,b),L=new a.Point(m,b),u._data.push({points:[R,L],extendleft:v.extendLeft,extendright:v.extendRight,leftend:l.LineEnd.Normal,rightend:l.LineEnd.Normal,width:e.width(),height:t.height(),color:P.color.value(),linewidth:P.width.value(),linestyle:P.style.value()}))})))},t}()},1221:function(t,e,i){"use strict";var n,a,o,s,r,l,d,h;Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"LinePaneView",function(){return h}),n=i(6),i.n(n),a=i(14),i.n(a),o=i(33),s=i(22),r=i(93),l=i(155),d=i(346),i.n(d),h=function(){function t(t,e){this._data=[],this._invalidated=!0,this._study=t,this._model=e}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,n,a;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new r.CompositeRenderer,e=0,i=this._data;e<i.length;e++)n=i[e],a=new d.TrendLineRenderer,a.setData(n),a.setHitTest(new s.HitTestResult(s.HitTestResult.REGULAR)),t.append(a);return t},t.prototype._updateViewInternal=function(){var t,e,i,s,r,d,h,u=this;this._data=[],t=this._study.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||(i=this._study.graphics().lines(),0!==i.size&&null!==(s=this._model.timeScale().visibleBars())&&null!=(r=this._study.firstValue())&&(d=s.firstBar(),h=s.lastBar(),i.forEach(function(i,s){var c,p,_,f,y,g,v,w,x,T,m,b,R,L,P,M,C,E=u._study.properties().graphics.lines[s];if(E.visible.value())for(c=0,p=i;c<p.length;c++)for(_=p[c],f=_.indexes,y=0,g=_.items;y<g.length;y++)v=g[y],w=f[v.startIndex],x=f[v.endIndex],w!==o.REMOVE_INDEX_MAGIC_NUMBER&&x!==o.REMOVE_INDEX_MAGIC_NUMBER&&(T=w+(v.startOffset||0),m=x+(v.endOffset||0),Math.max(T,m)<d||Math.min(T,m)>h||(b=e.indexToCoordinate(T),R=e.indexToCoordinate(m),L=t.priceToCoordinate(Object(n.ensureDefined)(v.startPrice),r),P=t.priceToCoordinate(Object(n.ensureDefined)(v.endPrice),r),M=new a.Point(b,L),C=new a.Point(R,P),u._data.push({points:[M,C],extendleft:!1,extendright:!1,leftend:l.LineEnd.Normal,rightend:l.LineEnd.Normal,width:e.width(),height:t.height(),color:E.color.value(),linewidth:E.width.value(),linestyle:E.style.value()})))})))},t}()},1222:function(t,e,i){"use strict";function n(t){if("up"===t)return 1;if("down"===t)return-1;throw Error(t+" is not supported by TriangleTextMarkRenderer")}var a,o,s,r,l,d,h,u,c,p,_,f,y,g,v,w,x;Object.defineProperty(e,"__esModule",{value:!0}),a=i(1),o=i(6),s=i(14),r=i(33),l=i(481),function(t){t.Triangle="triangle",t.Rectangle="rectangle"}(d||(d={})),function(t){t.Verdana="Verdana",t.CourierNew="Courier New",t.TimesNewRoman="Times New Roman",t.Arial="Arial"}(h||(h={})),u=i(93),
c=i(143),p=i(22),_=i(124),f=function(){function t(t,e){this._data=t,this._textCache=e}return t.prototype.draw=function(t){var e,i,a,o,s,r,l,d;this._data&&(e=n(this._data.direction),i=this._data.point.x,"left"===this._data.halign?i-=this._data.size:"right"===this._data.halign&&(i+=this._data.size),a=this._data.point.y,t.font=this._fontStyle(),o=t.measureText(this._data.text).width,this._textCache.textWidth=o,s=this._data.fontSize,r=Object(_.calcTextHorizontalShift)(t,o),l=.65*s,d=1*s,t.save(),t.translate(i+.5,a+.5),t.beginPath(),t.moveTo(0,0),t.lineTo(l,d*e),t.lineTo(.5*o+l,d*e),t.lineTo(.5*o+l,(d+1.75*s)*e),t.lineTo(.5*-o-l,(d+1.75*s)*e),t.lineTo(.5*-o-l,d*e),t.lineTo(-l,d*e),t.lineTo(0,0),t.strokeStyle=this._data.borderColor,t.stroke(),t.fillStyle=this._data.color,t.fill(),t.fillStyle=this._data.fontColor,t.fillText(this._data.text,.5*-o+r,e<0?e*d-.5*s:d+1.25*s),t.restore())},t.prototype.hitTest=function(t){var e,i,a,o,r,l,d,h,u=this._textCache.textWidth||0,_=this._data.fontSize,f=n(this._data.direction),y=.65*_,g=1*_,v=this._data.point.x;return"left"===this._data.halign?v-=this._data.size:"right"===this._data.halign&&(v+=this._data.size),e=this._data.point.y,i=v-.5*u-y,a=v+.5*u+y,o=e+g*f,r=e+(g+1.75*_)*f,r<o&&(l=o,o=r,r=l),Object(c.pointInRectangle)(t,new s.Point(i,o),new s.Point(a,r))?new p.HitTestResult(p.HitTestResult.REGULAR):(d=[new s.Point(this._data.point.x,this._data.point.y),new s.Point(this._data.point.x+.65*_,this._data.point.y+_*f),new s.Point(this._data.point.x-.65*_,this._data.point.y+_*f)],h=(t.x-d[0].x)*(d[1].y-d[0].y)-(t.y-d[0].y)*(d[1].x-d[0].x),((t.x-d[1].x)*(d[2].y-d[1].y)-(t.y-d[1].y)*(d[2].x-d[1].x))*h>0&&((t.x-d[2].x)*(d[0].y-d[2].y)-(t.y-d[2].y)*(d[0].x-d[2].x))*h>0?new p.HitTestResult(p.HitTestResult.REGULAR):null)},t.prototype._fontStyle=function(){return(this._data.bold?"bold ":"")+(this._data.italic?"italic ":"")+this._data.fontSize+"px "+this._data.font},t}(),y=function(){function t(t,e){this._data=t,this._textCache=e}return t.prototype.draw=function(t){var e,i=this._data.point.x,n=this._data.point.y;switch(t.font=this._fontStyle(),e=t.measureText(this._data.text).width,this._textCache.textWidth=e,t.save(),t.translate(i+.5,n+.5),t.beginPath(),t.moveTo(0,0),t.textAlign=this._data.halign,this._data.valign){case"middle":t.textBaseline="middle";break;case"top":t.textBaseline="bottom";break;case"bottom":t.textBaseline="hanging"}t.fillStyle=this._data.fontColor,t.fillText(this._data.text,0,0),t.restore()},t.prototype.hitTest=function(t){var e,i,n=this._data.point.x+.5,a=this._data.point.y+.5,o=this._textCache.textWidth||0,r=this._data.fontSize;switch(this._data.halign){case"right":n-=o;break;case"center":n-=o/2}switch(this._data.valign){case"middle":a-=r/2;break;case"bottom":a-=r}return e=new s.Point(n,a),i=new s.Point(n+o,a+r),Object(c.pointInRectangle)(t,e,i)?new p.HitTestResult(p.HitTestResult.REGULAR):null},t.prototype._fontStyle=function(){return(this._data.bold?"bold ":"")+(this._data.italic?"italic ":"")+this._data.fontSize+"px "+this._data.font},t}(),g=i(2382),v=i.n(g),w=i(96),
i.d(e,"TextMarkPaneView",function(){return x}),x=function(t){function e(e,i){var n=t.call(this)||this;return n._data=[],n._textCache=[],n._invalidated=!0,n._study=e,n._model=i,n._data=[],n._textCache=[],n}return a.__extends(e,t),e.prototype.update=function(){this._invalidated=!0},e.prototype.renderer=function(){var t,e,i,n;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new u.CompositeRenderer,e=0;e<this._data.length;e++)switch(i=this._data[e],n=this._textCache[e],i.shape){case"triangle":t.append(new f(i,n));break;case"rectangle":t.append(new y(i,n))}return t},e.prototype._updateViewInternal=function(){var t,e,i,n,o,l,h,u=this;this._data=[],t=this._study.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||(i=this._study.graphics().textmarks(),0!==i.size&&null!==(n=this._model.timeScale().visibleBars())&&null!=(o=this._study.firstValue())&&(l=n.firstBar(),h=n.lastBar(),i.forEach(function(i,n){var c,p,_,f,y,g,v,x,T,m,b,R,L,P,M,C,E,B=u._study.properties().graphics.textmarks[n];if(B.visible.value())for(c=0,p=i;c<p.length;c++)for(_=p[c],f=_.indexes,y=0,g=_.items;y<g.length;y++)if(v=g[y],!((x=f[v.time])===r.REMOVE_INDEX_MAGIC_NUMBER||x<l||h<x)&&null!==u._study.series().bars().valueAt(x)){switch(x=f[v.time]+(v.offset||0),T={text:v.text?v.text:"",bold:B.fontBold.value(),italic:B.fontItalic.value(),font:B.fontFamily.value(),fontColor:Object(w.generateColor)(B.fontColor.value(),B.transparency.value()),fontSize:B.fontSize.value()},m=B.location.value(),b=B.shape.value(),R=50,b){case d.Triangle:L=u._calcCoordsForTriangleShape(m,x,R,v.price,o,t,e),P=L.x,M=L.y,C=L.direction,u._data.push(a.__assign({shape:b,color:Object(w.generateColor)(B.color.value(),B.transparency.value()),borderColor:"rgb(0, 0, 0)",direction:C,point:new s.Point(P,M),halign:B.halign.value(),size:.5*e.barSpacing()},T));break;case d.Rectangle:E=u._calcCoordsForRectangleShape(m,x,v.price,o,t,e),P=E.x,M=E.y,u._data.push(a.__assign({shape:b,point:new s.Point(P,M),halign:B.halign.value(),valign:void 0!==B.valign?B.valign.value():"middle"},T))}u._textCache.push({})}})))},e.prototype._calcCoordsForTriangleShape=function(t,e,i,n,a,s,r){var d=Math.round(r.indexToCoordinate(e));switch(t){case l.MarkLocation.Top:return{x:d,y:s.height()-i,direction:"down"};case l.MarkLocation.Bottom:return{x:d,y:i,direction:"up"};case l.MarkLocation.AbsoluteDown:return{x:d,y:s.priceToCoordinate(Object(o.ensureDefined)(n),a),direction:"down"};case l.MarkLocation.AbsoluteUp:return{x:d,y:s.priceToCoordinate(Object(o.ensureDefined)(n),a),direction:"up"};case l.MarkLocation.AboveBar:return{x:d,y:this._locationToY(t,e),direction:"down"};case l.MarkLocation.BelowBar:default:return{x:d,y:this._locationToY(t,e),direction:"up"}}},e.prototype._calcCoordsForRectangleShape=function(t,e,i,n,a,s){var r=Math.round(s.indexToCoordinate(e));switch(t){case l.MarkLocation.AbsoluteDown:case l.MarkLocation.AbsoluteUp:case l.MarkLocation.Absolute:return{x:r,y:a.priceToCoordinate(Object(o.ensureDefined)(i),n)};case l.MarkLocation.AboveBar:case l.MarkLocation.BelowBar:
return{x:r,y:this._locationToY(t,e)};case l.MarkLocation.Right:case l.MarkLocation.Left:return{x:s.width(),y:a.priceToCoordinate(Object(o.ensureDefined)(i),n)};default:return{x:r,y:this._locationToY(t,e)}}},e}(v.a)},1285:function(t,e,i){"use strict";function n(t,e){a.call(this,t,e),this._calc=null,this._lines=[],this._pearsons=null,this._pearsonsLabelRenderer=new r({})}var a=i(471).LineSourcePaneView,o=i(2698).LinearRegressionPaneView,s=i(1961).ParallelChannelRenderer,r=i(411).TextRenderer,l=i(346).TrendLineRenderer,d=i(197).SelectionRenderer,h=i(22).HitTestResult,u=i(93).CompositeRenderer,c=i(96);inherit(n,a),n.prototype.getTransparencyResetLines=function(){return this._lines.map(function(t){var e=$.extend({},t);return e.color=c.resetTransparency(e.color),e})},n.prototype.renderer=function(){var t,e,i,n,a,o,r,p,_;for(this._invalidated&&(this._updateImpl(),this._invalidated=!1),t=new u,e=[],i=[this._lines[1],this._lines[0],this._lines[2]],n=[],a=0;a<i.length;a++)i[a]&&n.push(i[a]);for(a=1;a<n.length;a++)o={},o.points=[i[a].floatPoints[0],i[a].floatPoints[1],i[a-1].floatPoints[0],i[a-1].floatPoints[1]],o.color=i[a].color,o.width=this._model.timeScale().width(),o.height=this._source.priceScale().height(),o.linewidth=i[a].linewidth,o.linestyle=i[a].linestyle,o.extendleft=!1,o.extendright=i[a].extendright,o.backcolor=o.color,o.transparency=this._source.properties().styles.transparency.value(),o.skipLines=!0,o.fillBackground=!0,r=new s(new h(h.REGULAR)),r.setData(o),t.append(r);for(p=this.getTransparencyResetLines(),a=0;a<n.length;a++)r=new l,r.setData(p[a]),r.setHitTest(new h(h.REGULAR)),t.append(r),0!==a&&(e=e.concat(this._lines[a].floatPoints));return this._pearsons&&(this._pearsons.color=c.resetTransparency(this._pearsons.color),this._pearsonsLabelRenderer.setData(this._pearsons),t.append(this._pearsonsLabelRenderer)),this.isAnchorsRequired()&&this._lines&&this._lines.length>=1&&(t.append(new d({points:e})),_=this._lines[0].floatPoints,_[0].data=0,_[1].data=1,t.append(this.createLineAnchor({points:_}))),t},n.prototype._updateImpl=function(){a.prototype._updateImpl.call(this),o.prototype._updateImpl.call(this)},e.RegressionTrendPaneView=n},1939:function(t,e,i){"use strict";var n,a,o,s,r,l,d,h,u;Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"PolygonRenderer",function(){return u}),n=i(143),i.n(n),a=i(113),i.n(a),o=i(65),i.n(o),s=i(21),i.n(s),r=i(346),i.n(r),l=i(155),d=i(22),h=i(96),u=function(){function t(t){this._data=null,this._backHittest=new d.HitTestResult(d.HitTestResult.MOVEPOINT_BACKGROUND),this._points=[],this._hittest=t||new d.HitTestResult(d.HitTestResult.MOVEPOINT)}return t.prototype.setData=function(t){this._data=t,this._points=t.points},t.prototype.draw=function(t){var e,i,n,a;if(null!==this._data&&0!==this._points.length){for(t.beginPath(),t.lineCap="butt",t.strokeStyle=this._data.color,t.lineWidth=this._data.linewidth,Object(o.setLineStyle)(t,this._data.linestyle),e=this._points[0],t.moveTo(e.x,e.y),i=0,n=this._points;i<n.length;i++)a=n[i],t.lineTo(a.x,a.y)
;this._data.filled&&this._data.fillBackground&&(t.fillStyle=Object(h.generateColor)(this._data.backcolor,this._data.transparency),t.fill()),this._data.filled&&!this._data.skipClosePath&&t.closePath(),this._data.linewidth>0&&t.stroke(),this._points.length>1&&(this._data.leftend===l.LineEnd.Arrow&&r.TrendLineRenderer.prototype.drawArrow(this._points[1],this._points[0],t,t.lineWidth),this._data.rightend===l.LineEnd.Arrow&&r.TrendLineRenderer.prototype.drawArrow(this._points[this._points.length-2],this._points[this._points.length-1],t,t.lineWidth))}},t.prototype.hitTest=function(t){var e,i,o,r,l;if(null===this._data||void 0!==this._data.mouseTouchable&&!this._data.mouseTouchable)return null;for(e=s.CheckMobile.any()?24:3,i=1;i<this._points.length;i++)if(o=this._points[i-1],r=this._points[i],l=Object(a.distanceToSegment)(o,r,t),l.distance<=e)return this._hittest;return this._data.filled&&this._data.fillBackground&&this._points.length>0&&(o=this._points[0],r=this._points[this._points.length-1],l=Object(a.distanceToSegment)(o,r,t),l.distance<=e)?this._hittest:this._data.filled&&this._data.fillBackground&&Object(n.pointInPolygon)(t,this._data.points)?this._backHittest:null},t}()},1961:function(t,e,i){"use strict";function n(t,e,i,n){return null!==t?Object(r.intersectPolygonAndHalfplane)(t,Object(o.halfplaneThroughPoint)(Object(o.lineThroughPoints)(e,i),n)):null}var a,o,s,r,l,d,h,u,c;Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"ParallelChannelRenderer",function(){return c}),a=i(6),i.n(a),o=i(14),i.n(o),s=i(113),i.n(s),r=i(376),i.n(r),l=i(65),i.n(l),d=i(22),h=i(94),u=i(96),c=function(){function t(t,e){this._data=null,this._hittestResult=t||new d.HitTestResult(d.HitTestResult.MOVEPOINT),this._backHittestResult=e||new d.HitTestResult(d.HitTestResult.MOVEPOINT_BACKGROUND)}return t.prototype.setData=function(t){this._data=t},t.prototype.draw=function(t){var e,i,n,a,o,s,r,d;null===this._data||this._data.points.length<2||(t.lineCap="butt",t.strokeStyle=this._data.color,t.lineWidth=this._data.linewidth,Object(l.setLineStyle)(t,this._data.linestyle),e=this._data.points,i=e[0],n=e[1],this._data.skipLines||this._extendAndDrawLineSegment(t,i,n),4===this._data.points.length&&(a=this._data.points,o=a[2],s=a[3],this._data.skipLines||this._data.skipTopLine||this._extendAndDrawLineSegment(t,o,s),this._data.fillBackground&&this._drawBackground(t,this._data.points),this._data.showMidline&&!this._data.skipLines&&(t.strokeStyle=this._data.midcolor,t.lineWidth=this._data.midlinewidth,Object(l.setLineStyle)(t,this._data.midlinestyle),r=i.add(o).scaled(.5),d=n.add(s).scaled(.5),this._extendAndDrawLineSegment(t,r,d))))},t.prototype.hitTest=function(t){var e,i,n,a,o,s,r,l,d,h,u;if(null===this._data||this._data.points.length<2)return null;if(e=this._data.points,i=e[0],n=e[1],null!==(a=this._extendAndHitTestLineSegment(t,i,n)))return a;if(4===this._data.points.length&&!this._data.skipTopLine){if(o=this._data.points,s=o[2],r=o[3],null!==(l=this._extendAndHitTestLineSegment(t,s,r)))return l
;if(this._data.showMidline&&!this._data.skipLines&&(d=i.add(s).scaled(.5),h=n.add(r).scaled(.5),null!==(u=this._extendAndHitTestLineSegment(t,d,h))))return u}return this._data.hittestOnBackground&&this._data.fillBackground?this._hitTestBackground(t):null},t.prototype._getColor=function(){var t=Object(a.ensureNotNull)(this._data);return Object(u.generateColor)(t.backcolor,t.transparency)},t.prototype._extendAndDrawLineSegment=function(t,e,i){var n=this._extendAndClipLineSegment(e,i);null!==n&&Object(l.drawLine)(t,n[0].x,n[0].y,n[1].x,n[1].y)},t.prototype._extendAndHitTestLineSegment=function(t,e,i){var n,a=this._extendAndClipLineSegment(e,i);return null!==a&&(n=Object(s.distanceToSegment)(a[0],a[1],t),n.distance<=3)?this._hittestResult:null},t.prototype._extendAndClipLineSegment=function(t,e){var i=Object(a.ensureNotNull)(this._data);return Object(h.extendAndClipLineSegment)(t,e,i.width,i.height,i.extendleft,i.extendright)},t.prototype._drawBackground=function(t,e){var i,r,l,d=Object(a.ensureNotNull)(this._data),h=e[0],u=e[1],c=e[2],p=e[3];if(!(Object(o.equalPoints)(h,u)||Object(o.equalPoints)(c,p)||Object(s.distanceToLine)(h,u,c).distance<1e-6||Object(s.distanceToLine)(h,u,p).distance<1e-6||d.width<=0||d.height<=0||(i=[new o.Point(0,0),new o.Point(d.width,0),new o.Point(d.width,d.height),new o.Point(0,d.height)],r=i,r=n(r,h,u,p),d.extendright||(r=n(r,u,p,c)),r=n(r,p,c,h),d.extendleft||(r=n(r,c,h,u)),null===r))){for(t.beginPath(),t.moveTo(r[0].x,r[0].y),l=1;l<r.length;l++)t.lineTo(r[l].x,r[l].y);t.fillStyle=this._getColor(),t.fill()}},t.prototype._hitTestBackground=function(t){var e,i,n,o,s,r,l,d,h,u,c,p=Object(a.ensureNotNull)(this._data);return 4!==p.points.length?null:(e=p.points,i=e[0],n=e[1],o=e[2],s=(n.y-i.y)/(n.x-i.x),r=i.y+s*(t.x-i.x),l=o.y+s*(t.x-o.x),d=Math.max(r,l),h=Math.min(r,l),u=Math.min(i.x,n.x),c=Math.max(i.x,n.x),!p.extendleft&&t.x<u?null:!p.extendright&&t.x>c?null:t.y>=h&&t.y<=d?this._backHittestResult:null)},t}()},2130:function(t,e,i){"use strict";var n,a;i.d(e,"a",function(){return n}),i.d(e,"b",function(){return a}),function(t){t.LeftToRight="left_to_right",t.RightToLeft="right_to_left"}(n||(n={})),function(t){t.Relative="relative",t.Absolute="absolute"}(a||(a={}))},2382:function(t,e,i){"use strict";function n(){}var a=i(37),o=a.min,s=a.max,r=i(481).MarkLocation;n.prototype._locationToY=function(t,e,i){var n,a,l,d,h,u,c;switch(i||(i=0),n=[],a=this._study.priceScale(),t){case r.AboveBar:l=TradingView.HIGH_PLOT;break;case r.BelowBar:l=TradingView.LOW_PLOT}for(d=this._study.firstValue(),i>=1&&(i-=1),h=-i;h<=i;h++)null!==(u=this._study.series().bars().valueAt(e+h))&&(c=u[l],n.push(a.priceToCoordinate(c,d)));switch(t){case r.AboveBar:return o(n)-15;case r.BelowBar:return s(n)+15}},t.exports=n},2698:function(t,e,i){"use strict";function n(t){return t.map(function(t){var e=a.__assign({},t);return e.color=Object(l.resetTransparency)(e.color),e})}var a,o,s,r,l,d,h,u,c,p,_;Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"LinearRegressionPaneView",function(){return _}),a=i(1),o=i(6),i.n(o),s=i(14),
i.n(s),r=i(22),l=i(96),d=i(93),h=i(1961),u=i(346),i.n(u),c=i(411),i.n(c),p=i(155),_=function(){function t(t,e){this._invalidated=!0,this._lines=[],this._pearsonsTextRenderer=new c.TextRenderer({}),this._pearsons=null,this._model=t,this._source=e}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,a,s,c,p,_,f,y,g,v;for(this._invalidated&&(this._updateImpl(),this._invalidated=!1),t=new d.CompositeRenderer,e=[this._lines[1],this._lines[0],this._lines[2]],i=[],a=0,s=e;a<s.length;a++)(c=s[a])&&i.push(c);for(p=1;p<i.length;p++)_={points:[e[p].floatPoints[0],e[p].floatPoints[1],e[p-1].floatPoints[0],e[p-1].floatPoints[1]],color:e[p].color,width:this._model.timeScale().width(),height:Object(o.ensureNotNull)(this._source.priceScale()).height(),linewidth:e[p].linewidth,linestyle:e[p].linestyle,extendleft:!1,extendright:e[p].extendright,backcolor:e[p].color,transparency:this._source.properties().styles.transparency.value(),skipLines:!0,fillBackground:!0,showMidline:!1},f=new h.ParallelChannelRenderer(new r.HitTestResult(r.HitTestResult.REGULAR),new r.HitTestResult(r.HitTestResult.REGULAR)),f.setData(_),t.append(f);for(y=0,g=n(this._lines);y<g.length;y++)v=g[y],f=new u.TrendLineRenderer,f.setData(v),f.setHitTest(new r.HitTestResult(r.HitTestResult.REGULAR)),t.append(f);return this._pearsons&&(this._pearsons.color=Object(l.resetTransparency)(this._pearsons.color),this._pearsonsTextRenderer.setData(this._pearsons),t.append(this._pearsonsTextRenderer)),t},t.prototype._updateImpl=function(){var t,e,i,n,a,r,l,d,h,u,c,_,f,y,g,v,w,x,T,m,b,R,L,P,M,C;if(this._lines=[],this._pearsons=null,this._source.properties().visible.value()&&(t=this._model.timeScale(),e=this._source.priceScale(),i=this._model.mainSeries(),n=i.firstBar(),e&&!e.isEmpty()&&!t.isEmpty()&&n&&(a=this._source.startIndex(),r=this._source.endIndex(),null!==a&&null!==r))){for(l=[this._source.baseLine(),this._source.downLine(),this._source.upLine()],d=Math.round(t.indexToCoordinate(a)),h=Math.round(t.indexToCoordinate(r)),u=this._source.properties(),c=[u.styles.baseLine,u.styles.downLine,u.styles.upLine],_=n[TradingView.CLOSE_PLOT],f=0;f<l.length;f++)c[f].visible.value()&&(y=Object(o.ensureNotNull)(l[f]).startPrice,g=Object(o.ensureNotNull)(l[f]).endPrice,void 0!==y&&void 0!==g&&(v=e.priceToCoordinate(y,_,!0),w=e.priceToCoordinate(g,_,!0),x=new s.Point(d,v),T=new s.Point(h,w),m=c[f].color.value(),b=c[f].linewidth.value(),R=c[f].linestyle.value(),L={floatPoints:[x,T],width:this._model.timeScale().width(),height:Object(o.ensureNotNull)(this._source.priceScale()).height(),color:m,linewidth:b,linestyle:R,extendleft:!1,extendright:u.styles.extendLines.value(),leftend:p.LineEnd.Normal,rightend:p.LineEnd.Normal},this._lines.push(L)));P=Object(o.ensureNotNull)(this._source.downLine()),u.styles.showPearsons.value()&&void 0!==P.startPrice&&(M=e.priceToCoordinate(P.startPrice,_),C=new s.Point(d,M),this._pearsons={points:[C],text:""+this._source.pearsons(),color:u.styles.downLine.color.value(),vertAlign:"top",horzAlign:"center",
font:"Arial",offsetX:0,offsetY:4,fontsize:12})}},t}()},2928:function(t,e,i){"use strict";var n,a,o,s,r,l,d,h;Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"VertLinePaneView",function(){return h}),n=i(6),i.n(n),a=i(14),i.n(a),o=i(33),s=i(22),r=i(93),l=i(155),d=i(346),i.n(d),h=function(){function t(t,e){this._data=[],this._invalidated=!0,this._study=t,this._model=e}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,n,a;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new r.CompositeRenderer,e=0,i=this._data;e<i.length;e++)n=i[e],a=new d.TrendLineRenderer,a.setData(n),a.setHitTest(new s.HitTestResult(s.HitTestResult.REGULAR)),t.append(a);return t},t.prototype._updateViewInternal=function(){var t,e,i,s,r,d,h,u=this;this._data=[],t=this._study.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||(i=this._study.graphics().vertlines(),0!==i.size&&null!==(s=this._model.timeScale().visibleBars())&&null!=(r=this._study.firstValue())&&(d=s.firstBar(),h=s.lastBar(),i.forEach(function(i,s){var c,p,_,f,y,g,v,w,x,T,m,b,R,L=u._study.properties().graphics.vertlines[s];if(L.visible.value())for(c=0,p=i;c<p.length;c++)for(_=p[c],f=_.indexes,y=0,g=_.items;y<g.length;y++)v=g[y],(w=f[v.index])===o.REMOVE_INDEX_MAGIC_NUMBER||w<d||h<w||(x=e.indexToCoordinate(w)+1,T=v.extendBottom?t.height():t.priceToCoordinate(Object(n.ensureDefined)(v.startPrice),r),m=v.extendTop?0:t.priceToCoordinate(Object(n.ensureDefined)(v.endPrice),r),b=new a.Point(x,T),R=new a.Point(x,m),u._data.push({points:[b,R],extendleft:v.extendBottom,extendright:v.extendTop,leftend:l.LineEnd.Normal,rightend:l.LineEnd.Normal,width:e.width(),height:t.height(),color:L.color.value(),linewidth:L.width.value(),linestyle:L.style.value()}))})))},t}()},2929:function(t,e,i){"use strict";var n,a,o,s,r,l;Object.defineProperty(e,"__esModule",{value:!0}),n=i(33),a=i(93),o=i(124),s=i(96),r=function(){function t(t){this._data=t}return t.prototype.draw=function(t){},t.prototype.drawBackground=function(t){var e=this._data,i=Object(s.generateColor)(this._data.color,this._data.transparency);Object(o.clearRect)(t,e.x1,e.y1,e.x2-e.x1,e.y2-e.y1,i)},t.prototype.hitTest=function(t){return null},t}(),i.d(e,"BackgroundPaneView",function(){return l}),l=function(){function t(t,e){this._data=[],this._invalidated=!0,this._study=t,this._model=e,this._data=[]}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,n;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new a.CompositeRenderer,e=0,i=this._data;e<i.length;e++)n=i[e],t.append(new r(n));return t},t.prototype._hideExtendedHours=function(t){return("inSession"===t||"outOfSession"===t)&&!this._study.series().properties().extendedHours.value()},t.prototype._updateViewInternal=function(){var t,e,i,a,o,s,r=this;this._data=[],t=this._study.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||(i=this._study.graphics().backgrounds(),
0!==i.size&&null!==(a=this._model.timeScale().visibleBars())&&(o=a.firstBar(),s=a.lastBar(),i.forEach(function(i,a){var l,d,h,u,c,p,_,f,y,g,v,w,x,T=r._study.properties().graphics.backgrounds[a];if(T.visible.value()&&!r._hideExtendedHours(a))for(l=0,d=i;l<d.length;l++)for(h=d[l],u=h.indexes,c=void 0,p=void 0,_=0,f=h.items;_<f.length;_++)y=f[_],g=u[y.start],v=u[y.stop],g===n.REMOVE_INDEX_MAGIC_NUMBER||v===n.REMOVE_INDEX_MAGIC_NUMBER||v<o||s<g||(w=Math.ceil(e.indexToCoordinate(g,!0)-.5*e.barSpacing()),x=Math.ceil(e.indexToCoordinate(v,!0)+.5*e.barSpacing()),p===g-1&&(w=c||w),c=x,p=v,w<0&&x<0||w>e.width()&&x>e.width()||r._data.push({x1:w,x2:x,y1:0,y2:t.height(),color:T.color.value(),transparency:T.transparency.value()}))})))},t}()},2930:function(t,e,i){"use strict";function n(t,e){if(t===l.TopLeft||t===l.MiddleLeft||t===l.BottomLeft)return["left",4];if(t===l.TopCenter||t===l.MiddleCenter||t===l.BottomCenter)return["center",e/2];if(t===l.TopRight||t===l.MiddleRight||t===l.BottomRight)return["right",e];throw Error("Unsupported TextPos value")}function a(t,e){if(t===l.TopLeft||t===l.TopCenter||t===l.TopRight)return["bottom",e-4];if(t===l.MiddleLeft||t===l.MiddleCenter||t===l.MiddleRight)return["middle",e-2];if(t===l.BottomLeft||t===l.BottomCenter||t===l.BottomRight)return["top",e];throw Error("Unsupported TextPos value")}var o,s,r,l,d,h,u,c;Object.defineProperty(e,"__esModule",{value:!0}),o=i(6),s=i(14),r=i(22),function(t){t[t.TopLeft=0]="TopLeft",t[t.TopCenter=1]="TopCenter",t[t.TopRight=2]="TopRight",t[t.MiddleLeft=3]="MiddleLeft",t[t.MiddleCenter=4]="MiddleCenter",t[t.MiddleRight=5]="MiddleRight",t[t.BottomLeft=6]="BottomLeft",t[t.BottomCenter=7]="BottomCenter",t[t.BottomRight=8]="BottomRight"}(l||(l={})),d=i(93),h=i(350),u=i(411),i.d(e,"LevelPaneView",function(){return c}),c=function(){function t(t,e){this._data=[],this._textData=[],this._invalidated=!0,this._study=t,this._model=e}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,n,a,o,s,l;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new d.CompositeRenderer,e=0,i=this._data;e<i.length;e++)n=i[e],a=new h.HorizontalLineRenderer,a.setData(n),t.append(a);for(o=0,s=this._textData;o<s.length;o++)l=s[o],t.append(new u.TextRenderer(l,new r.HitTestResult(r.HitTestResult.REGULAR)));return t},t.prototype._updateViewInternal=function(){this._calcHorzLinesData(),this._calcTextData()},t.prototype._calcTextData=function(){var t,e,i,r,l=this;this._textData=[],t=this._study.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||(i=this._study.graphics().hlines(),0!==i.size&&null!=(r=this._study.firstValue())&&i.forEach(function(i,d){var h,u,c,p,_,f,y,g,v,w,x,T,m,b,R=l._study.properties().graphics.hlines[d];if(R.enableText.value()&&R.showText.value())for(h=0,u=i;h<u.length;h++)for(c=u[h],p=0,_=c.items;p<_.length;p++)f=_[p],y=t.priceToCoordinate(Object(o.ensureDefined)(f.level),r),g=R.textPos.value(),v=n(g,e.width()),w=v[0],x=v[1],T=a(g,y),m=T[0],b=T[1],l._textData.push({
points:[new s.Point(x,b)],offsetX:0,offsetY:0,text:f.text||"",color:R.color.value(),font:"arial",fontsize:R.fontSize.value(),horzAlign:w,vertAlign:m})}))},t.prototype._calcHorzLinesData=function(){var t,e,i,n,a=this;this._data=[],t=this._study.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||(i=this._study.graphics().hlines(),0!==i.size&&null!=(n=this._study.firstValue())&&i.forEach(function(i,r){var l,d,h,u,c,p,_,f=a._study.properties().graphics.hlines[r];if(f.visible.value())for(l=0,d=i;l<d.length;l++)for(h=d[l],u=0,c=h.items;u<c.length;u++)p=c[u],_=t.priceToCoordinate(Object(o.ensureDefined)(p.level),n),a._data.push({visible:!0,points:[new s.Point(0,_)],width:e.width(),height:t.height(),color:f.color.value(),linewidth:f.width.value(),linestyle:f.style.value()})}))},t}()},2931:function(t,e,i){"use strict";var n,a,o,s,r,l,d,h,u,c,p,_,f,y,g,v,w;Object.defineProperty(e,"__esModule",{value:!0}),n=i(1),a=i(6),o=i(14),s=i(33),r=i(481),l=i(93),d=i(143),h=i(22),u=function(){function t(t){this._data=t}return t.prototype.draw=function(t){var e="down"===this._data.direction?1:"up"===this._data.direction?-1:0,i=this._data.point.x,n=this._data.point.y;t.save(),t.fillStyle=this._data.color,t.beginPath(),t.arc(i+1,n+2*this._data.size*e+.5,this._data.size,0,2*Math.PI),t.closePath(),t.fill(),t.stroke(),t.restore()},t.prototype.hitTest=function(t){var e="down"===this._data.direction?1:"up"===this._data.direction?-1:0,i=new o.Point(this._data.point.x+.5,this._data.point.y+.5+2*this._data.size*e);return Object(d.pointInCircle)(t,i,this._data.size)?new h.HitTestResult(h.HitTestResult.REGULAR):null},t}(),c=function(){function t(t){this._data=t}return t.prototype.draw=function(t){var e="down"===this._data.direction?1:"up"===this._data.direction?-1:0,i=this._data.size,n=new o.Point(this._data.point.x-i/2,this._data.point.y-i/2+e*i),a=new o.Point(this._data.point.x+i/2,this._data.point.y+i/2+e*i),s=a.subtract(n);t.beginPath(),t.fillStyle=this._data.color,t.rect(n.x,n.y,s.x,s.y),t.stroke(),t.fill()},t.prototype.hitTest=function(t){var e="down"===this._data.direction?1:"up"===this._data.direction?-1:0,i=this._data.size,n=new o.Point(this._data.point.x-i/2,this._data.point.y-i/2+e*i),a=new o.Point(this._data.point.x+i/2,this._data.point.y+i/2+e*i),s=new o.Point(Math.min(n.x,a.x),Math.min(n.y,a.y)),r=new o.Point(Math.max(n.x,a.x),Math.max(n.y,a.y));return Object(d.pointInRectangle)(t,s,r)?new h.HitTestResult(h.HitTestResult.REGULAR):null},t}(),p=function(){function t(t,e){this._data=t,this._arrowDirection=e}return t.prototype.draw=function(t){var e,i,n,a,o,s=this._arrowDirection,r=this._data.size,l=this._data.color,d=this._data.point.x+1,h=this._data.point.y,u=1.1*r;switch(s){case"up":h-=u;break;case"down":h+=u}switch(e=r/6,i=r/4,n=r/3,a=r/2,o=.6666666*r,t.save(),t.fillStyle=l,t.beginPath(),s){case"up":t.moveTo(d,h),t.lineTo(d-a,h+o),t.lineTo(d-i,h+o),t.lineTo(d,h+n),t.lineTo(d+i,h+o),t.lineTo(d+a,h+o),t.lineTo(d,h);break;case"down":t.moveTo(d,h+r),t.lineTo(d-a,h+n),t.lineTo(d-i,h+n),t.lineTo(d,h+o),t.lineTo(d+i,h+n),
t.lineTo(d+a,h+n),t.lineTo(d,h+r);break;case"right":t.moveTo(d+e,h),t.lineTo(d-e,h-i),t.lineTo(d-e,h+i),t.lineTo(d+e,h);break;case"left":t.moveTo(d-e,h),t.lineTo(d+e,h-i),t.lineTo(d+e,h+i),t.lineTo(d-e,h)}t.closePath(),t.fill(),t.stroke(),t.restore()},t.prototype.hitTest=function(t){var e=this._hitTriangle(),i=e[0],n=e[1],a=e[2];return Object(d.pointInTriangle)(t,i,n,a)?new h.HitTestResult(h.HitTestResult.REGULAR):null},t.prototype._hitTriangle=function(){var t,e,i,n,a,s=this._data.point.x,r=this._data.point.y,l=this._arrowDirection,d=this._data.size,h=1.1*d;switch(l){case"up":r-=h;break;case"down":r+=h}switch(t=d/6,e=d/4,i=d/3,n=d/2,a=.6666666*d,l){case"up":return[new o.Point(s,r),new o.Point(s+n,r+a),new o.Point(s-n,r+a)];case"down":return[new o.Point(s,r+d),new o.Point(s+n,r+i),new o.Point(s-n,r+i)];case"right":return[new o.Point(s+t,r),new o.Point(s-t,r-e),new o.Point(s-t,r+e)];case"left":return[new o.Point(s-t,r),new o.Point(s+t,r-e),new o.Point(s+t,r+e)]}},t}(),_=i(2382),f=i.n(_),y=i(96),g=i(0),i.d(e,"ShapeMarkPaneView",function(){return w}),v=Object(g.getLogger)("Chart.ShapeMarkPaneView"),w=function(t){function e(e,i){var n=t.call(this)||this;return n._data=[],n._invalidated=!0,n._study=e,n._model=i,n._data=[],n}return n.__extends(e,t),e.prototype.update=function(){this._invalidated=!0},e.prototype.renderer=function(){var t,e,i,n;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new l.CompositeRenderer,e=0,i=this._data;e<i.length;e++)switch(n=i[e],n.shape){case"circle":t.append(new u(n));break;case"square":t.append(new c(n));break;case"arrowUp":t.append(new p(n,"up"));break;case"arrowDown":t.append(new p(n,"down"));break;case"arrowRight":t.append(new p(n,"right"));break;case"arrowLeft":t.append(new p(n,"left"))}return t},e.prototype._updateViewInternal=function(){var t,e,i,n,a,r,l,d=this;this._data=[],t=this._study.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||(i=this._study.graphics().shapemarks(),0!==i.size&&null!==(n=this._model.timeScale().visibleBars())&&null!=(a=this._study.firstValue())&&(r=n.firstBar(),l=n.lastBar(),i.forEach(function(i,n){var h,u,c,p,_,f,g,v,w,x,T,m,b,R,L,P,M,C=d._study.properties().graphics.shapemarks[n];if(C.visible.value())for(h=0,u=i;h<u.length;h++)for(c=u[h],p=c.indexes,_=0,f=c.items;_<f.length;_++)if(g=f[_],!((v=p[g.time])===s.REMOVE_INDEX_MAGIC_NUMBER||v<r||l<v)&&null!==d._study.series().bars().valueAt(v))switch(w="left"===C.halign.value()?-(e.barSpacing()/2+1):"right"===C.halign.value()?e.barSpacing()/2+1:0,x=C.location.value(),T=C.shape.value(),m=parseInt(C.size.value()),b=Object(y.generateColor)(C.color.value(),C.transparency.value()),R=d._calcCoordsForShape(x,v,m,g.price,a,t,e),L=R.x,P=R.y,M=R.direction,T){case"circle":case"square":d._data.push({shape:T,color:b,direction:M,point:new o.Point(L+w,P),size:m});break;case"arrowUp":case"arrowDown":case"arrowRight":case"arrowLeft":d._data.push({shape:T,color:b,point:new o.Point(L+w,P),size:m})}})))},e.prototype._calcCoordsForShape=function(t,e,i,n,o,s,l){
var d=Math.round(l.indexToCoordinate(e));switch(t){case r.MarkLocation.Absolute:return{x:d,y:s.priceToCoordinate(Object(a.ensureDefined)(n),o),direction:""};case r.MarkLocation.AbsoluteDown:return{x:d,y:s.priceToCoordinate(Object(a.ensureDefined)(n),o),direction:"down"};case r.MarkLocation.AbsoluteUp:return{x:d,y:s.priceToCoordinate(Object(a.ensureDefined)(n),o),direction:"up"};case r.MarkLocation.AboveBar:return{x:d,y:this._locationToY(t,e,Math.floor(2*i/l.barSpacing())+1),direction:"up"};case r.MarkLocation.BelowBar:return{x:d,y:this._locationToY(t,e,Math.floor(2*i/l.barSpacing())+1),direction:"down"};default:return v.logWarn("Bad location value: "+t),{x:d,y:this._locationToY(r.MarkLocation.AbsoluteUp,e),direction:"up"}}},e}(f.a)},2932:function(t,e,i){"use strict";function n(t,e,i,n,a,r){var l,d,h,u;return Object(o.equalPoints)(t,e)?[t,e]:(l=new o.Point(0,0),d=new o.Point(i,n),a&&(h=t.subtract(e),u=Object(s.intersectRayAndRectangle)(t,t.add(h),l,d),u?t=u:e=new o.Point(i,e.y)),r&&(h=e.subtract(t),u=Object(s.intersectRayAndRectangle)(e,e.add(h),l,d),e=u||new o.Point(i,e.y)),[t,e])}var a,o,s,r,l,d,h,u,c;Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"TrendChannelPaneView",function(){return c}),a=i(6),i.n(a),o=i(14),i.n(o),s=i(376),i.n(s),r=i(33),l=i(22),d=i(93),h=i(116),u=i(1939),c=function(){function t(t,e){this._data=[],this._invalidated=!0,this._study=t,this._model=e,this._data=[]}return t.prototype.update=function(){this._invalidated=!0},t.prototype.renderer=function(){var t,e,i,n,a;for(this._invalidated&&(this._updateViewInternal(),this._invalidated=!1),t=new d.CompositeRenderer,e=0,i=this._data;e<i.length;e++)n=i[e],a=new u.PolygonRenderer(new l.HitTestResult(l.HitTestResult.REGULAR)),a.setData(n),t.append(a);return t},t.prototype._updateViewInternal=function(){var t,e,i,s,l,d,u,c=this;this._data=[],t=this._study.priceScale(),e=this._model.timeScale(),!t||t.isEmpty()||e.isEmpty()||(i=this._study.graphics().trendchannels(),0!==i.size&&null!==(s=this._model.timeScale().visibleBars())&&null!=(l=this._study.firstValue())&&(d=s.firstBar(),u=s.lastBar(),i.forEach(function(i,s){var p,_,f,y,g,v,w,x,T,m,b,R,L,P,M,C,E,B,O,S,k,A,D=c._study.properties().graphics.trendchannels[s];for(p=0,_=i;p<_.length;p++)for(f=_[p],y=f.indexes,g=0,v=f.items;g<v.length;g++)w=v[g],x=y[w.startIndex],T=y[w.endIndex],x===r.REMOVE_INDEX_MAGIC_NUMBER||T===r.REMOVE_INDEX_MAGIC_NUMBER||Math.max(x,T)<d&&!w.extendRight||Math.min(x,T)>u&&!w.extendLeft||(m=t.priceToCoordinate(Object(a.ensureDefined)(w.startHighPrice),l),b=t.priceToCoordinate(Object(a.ensureDefined)(w.startLowPrice),l),R=t.priceToCoordinate(Object(a.ensureDefined)(w.endHighPrice),l),L=m-b,P=R-L,M=e.indexToCoordinate(x),C=e.indexToCoordinate(T),E=n(new o.Point(M,m),new o.Point(C,R),e.width(),t.height(),w.extendLeft,w.extendRight),B=E[0],O=E[1],S=n(new o.Point(M,b),new o.Point(C,P),e.width(),t.height(),w.extendLeft,w.extendRight),k=S[0],A=S[1],c._data.push({points:[B,k,A,O],color:D.color.value(),backcolor:D.color.value(),linewidth:void 0!==D.borderWidth?D.borderWidth.value():0,
linestyle:h.LINESTYLE_SOLID,filled:!0,fillBackground:!0,transparency:w.transparency?Math.min(w.transparency+D.transparency.value(),100):D.transparency.value(),mouseTouchable:!0}))})))},t}()}});